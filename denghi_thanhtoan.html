<!doctype html>
<meta charset="utf-8">
<title>Đề nghị thanh toán</title>
<meta name="csrf-token" content="MHMXdIG4tBlzbq7sMs8y0wjq43Dtbf8PaMgnKDS3">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
<link rel="shortcut icon" href="https://rndwows.github.io/hcnswows/logowows.jpg" type="image/x-icon">
<!-- jQuery library -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.slim.min.js"></script>

<!-- Popper JS -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />


<style>
    body {
        background: rgb(204, 204, 204);
        font-family: "Times New Roman", Times, serif;
    }

    .fixed-button {
        position: fixed;
        bottom: 20px;
        /* Điều chỉnh vị trí từ dưới lên, bạn có thể thay đổi giá trị này */
        right: 20px;
        /* Điều chỉnh vị trí từ phải sang, bạn có thể thay đổi giá trị này */
        width: 100%;
        max-width: 400px;
        /* Điều chỉnh chiều rộng tối đa của button */
        display: flex;
        gap: 10px;
    }

    .btn-fixed {
        flex: 1;
    }

    page {
        background: white;
        display: block;
        margin: 0 auto;
        margin-bottom: 0.5cm;
        box-shadow: 0 0 0.5cm rgba(0, 0, 0, 0.5);
    }

    page[size="A4"][layout="portrait"] {
        width: 21cm;
        height: 100%;

    }

    @media print {

        body,
        #content {
            margin: 0;
            box-shadow: 0;
            font-size: 18px !important;
        }

        h5 {
            font-size: 24px
        }

        input {
            text-align: center;
        }

        .no-print,
        .fixed-button {
            display: none !important;
        }

        .big-title {
            font-size: 18px !important;
        }

        .total-pay {
            font-size: 15px !important;
        }

        @page {
            size: auto;
        }

        #content-split {
            margin-top: 40px;
            position: absolute;
            top: 50%;
            width: 920px;
        }

        .height_hr {
            border-top: 3px dashed black;
            width: 100%;
            position: absolute;
            top: 49%;
        }

        #content-split .div-logo {
            position: relative;
            top: -10px;
            left: 10px;
        }
    }

    #content {
        font-size: 13.5px;

    }


    .center {
        text-align: center;
    }

    .right {
        text-align: right;
    }

    .bold {
        font-weight: bold;
    }

    .big-title {
        font-size: 15px;
    }

    #fixed-panel,
    #fixed-show-user,
    #fixed-show-reason {
        font-size: 13px;
    }


    #content {
        padding: 40px 40px;
    }

    #select-setup-print {
        position: relative;
        top: -2px;
        background-color: #17a2b8;
        color: white;
    }

    #setup-print {
        position: fixed;
        top: 480px;
        left: 30px;
        width: 150px;
        height: 54px;
        background-color: #ffffff;
        padding: 10px;
        border-radius: 5px;
        /*font-size: 13px;*/
        box-shadow: 0 0 0.5cm rgba(0, 0, 0, 0.5);
    }


    .heigth-90px {
        height: 90px !important;
    }

    #page {
        margin-top: 20px;
        margin-bottom: 20px;
        position: relative;
    }


    .big-title {
        text-transform: uppercase;
        font-weight: bold;
        /*font-size: 15px;*/
        padding-bottom: 5px;
    }

    hr {
        margin-top: 5px;
        margin-bottom: 5px;
    }

    .bold {
        font-weight: bold;
    }

    .info_student {
        margin-top: 10px;
        text-align: justify;
    }

    .info_contract {
        margin-bottom: 5px !important
    }


    @media only screen and (max-width: 1024px) {
        #fixed-panel {
            display: none !important;
        }

        #list_option_print {
            display: none !important;
        }
    }

    @media print {
        #accountSelect {
            display: none !important;
        }
    }

    #accountSelect {
        display: none;
    }
</style>

<body>
    <div class="fixed-button">
        <button onclick="print()" class="btn btn-info btn-fixed"><i class="fa fa-print"></i> <span class="language_print">In đề nghị</span></button>
        <button onclick="toggleBankAccount()" class="btn btn-info btn-fixed"><i class="fas fa-exchange-alt"></i> Đổi tài khoản</button>
        <button onclick="toggleSignature()" class="btn btn-info btn-fixed"><i class="fas fa-signature"></i> <span id="signatureButtonText">Ẩn chữ ký</span></button>
    </div>
    <page size="A4" id="page" layout="portrait">
        <div id="content">
            <div class="content_page1">
                <table style="width: 100%;">
                    <tr>
                        <th rowspan="4"> <img src="https://rndwows.github.io/hcnswows/logowows.jpg"
                                style="width: 100px; margin: -30px"></th>
                        <th style="width: 60%;" rowspan="4">
                            <h5 class=" bold">CÔNG TY CỔ PHẦN TẬP ĐOÀN WOWS</h5>
                        </th>
                        <td style="font-size: 12px;">Mã hiệu: </th>
                        <td style="font-size: 12px;"><span>WS-KD-QT02/BM05</span></th>
                    </tr>
                    <tr>
                        <td style="font-size: 12px;"> Lần ban hành: 01</td>
                        <td style="font-size: 12px;">Hiệu chỉnh lần: 00</td>
                    </tr>
                    <tr>
                        <td style="font-size: 12px;">Ngày ban hành: <span>01/07/2024</td>
                        <td style="font-size: 12px;">Ngày hiệu chỉnh: <span>00</td>
                    </tr>
                    <tr>
                        <td style="font-size: 12px;">Số:</td>
                        <td style="font-size: 12px;">DNTT-<span id="tvt"></span>-<span id="currentDate"></span>-<input
                                type="text" id="sequenceNumber" class="no-print"
                                style="width: 40px; border: none; border-bottom: 1px solid black;"><span
                                id="sequenceNumberDisplay"></span></td>
                </table>

                <div style="clear: both"></div>
                <br>
                <h2 style="text-align: center;" class="bold"><span>ĐỀ NGHỊ THANH TOÁN</span></h2>

                <i>Bình Dương, Ngày
                    <input type="text" id="day" class="date-input" style="width: 30px; border: none;">
                    Tháng
                    <input type="text" id="month" class="date-input" style="width: 30px; border: none;">
                    Năm
                    <input type="text" id="year" class="date-input" style="width: 50px; border: none;">
                </i>

                <div class="info_student">
                    <table style="width: 100%; ">
                        <tr>
                            <td colspan="2">Kính gửi: <span id="name"></span></td>
                        </tr>
                        <tr>
                            <td colspan="2">Công ty: <span id="cty"></span></td>
                        </tr>
                        <tr>
                            <td colspan="2">Địa chỉ liên hệ: <span id="dclh"></span></td>
                        </tr>
                        <tr>
                            <td colspan="2">MST: <span id="mst"></span></td>
                        </tr>
                        <tr>
                            <td colspan="2">Nội dung: <span id="ndtt"></span> - Hợp đồng số <span id="idhd1"></span>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">Thay mặt Công Ty Cổ Phần Tập Đoàn Wows xin cảm ơn Quý công ty đã tin tưởng
                                và sử dụng dịch vụ của chúng tôi. </td>
                        </tr>
                        <tr>
                            <td colspan="2">Căn cứ theo nội dung hợp đồng đã ký, Quý công ty có trách nhiệm thanh toán
                                đợt <span id="ltt2"></span> cho WOWS số tiền <span class="bold" id="ttt"></span><span
                                    class="bold"> VND</span></td>
                        </tr>
                        <tr>
                            <td colspan="2"><i>(Bằng chữ: <span id="tttbc"></span>)</i></td>
                        </tr>
                        <tr>
                            <td colspan="2">Kính đề nghị Quý Công ty thanh toán trong vòng 03 (ba) ngày làm việc sau khi
                                chúng tôi gửi Đề nghị thanh toán. </td>
                        </tr>

                        <tr>
                            <td colspan="2" class="bold">Vui lòng thanh toán bằng chuyển khoản qua số tài khoản sau:
                            </td>
                        </tr>
                    </table>

                    <select id="accountSelect" onchange="updateBankDetails()">
                        <option value="0">Ngân Hàng Vietcombank - 0281000569347</option>
                        <option value="1">VCB: 1025576073 CONG TY CO PHAN TAP DOAN WOWS</option>
                    </select>
                    <table style="width: 100%; ">
                        <tr>
                            <td colspan="2">Số tài khoản: <span id="accountNumber" class="bold"></span></td>
                        </tr>
                        <tr>
                            <td colspan="2">Chủ tài khoản: <span id="accountHolder"></span></td>
                        </tr>
                        <tr>
                            <td colspan="2">Ngân hàng thụ hưởng: <span id="bankName"></span></td>
                        </tr>
                        <tr>
                            <td colspan="2">Rất mong nhận được sự hợp tác của Quý Công ty.</td>
                        </tr>

                    </table>
                </div>

                <br>

                <table style="width: 100%; ">
                    <tr>
                        <td style="width: 50%;"></td>
                        <td style="width: 50%; text-align: center;"><span class="bold">CÔNG TY CỔ PHẦN TẬP ĐOÀN WOWS</span></td>
                    </tr>
                    <tr>
                        <td><span>Nơi nhận<br>Như trên <br>Lưu VP.</span></td>
                        <td style="width: 50%; text-align: center;">
                            (Tổng Giám Đốc) <br> 
                            <img id="signatureImage" src="https://rndwows.github.io/hcnswows/%E1%BA%A2nh1.png" style="width: 150px; margin-top: 10px;">
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td style="width: 50%; text-align: center;">
                            <p class="bold">BÀ ĐỖ THỊ KIM THỦY</p>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </page>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/printThis/1.15.0/printThis.min.js"
        integrity="sha512-d5Jr3NflEZmFDdFHZtxeJtBzk0eB+kkRXWFQqEc1EKmolXjHm2IKCA7kTvXBNjIYzjXfD5XzIjaaErpkZHCkBg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.centeronline.edu.vn/js/customer.js" type="text/javascript"></script>

    <script>
        // New function to convert numbers to Vietnamese text
        function convertNumberToVietnamese(number) {
            if (number === 0) return "Không đồng";
            
            const units = ["", "một", "hai", "ba", "bốn", "năm", "sáu", "bảy", "tám", "chín"];
            const teens = ["", "mười một", "mười hai", "mười ba", "mười bốn", "mười lăm", "mười sáu", "mười bảy", "mười tám", "mười chín"];
            const tens = ["", "mười", "hai mươi", "ba mươi", "bốn mươi", "năm mươi", "sáu mươi", "bảy mươi", "tám mươi", "chín mươi"];
            const scales = ["", "nghìn", "triệu", "tỷ", "nghìn tỷ", "triệu tỷ"];
            
            function readGroup(triplet) {
                let result = "";
                
                // Read hundreds
                if (triplet[0] !== 0) {
                    result += units[triplet[0]] + " trăm ";
                    if (triplet[1] === 0 && triplet[2] !== 0) {
                        result += "lẻ ";
                    }
                }
                
                // Read tens and units
                if (triplet[1] !== 0) {
                    if (triplet[1] === 1) {
                        if (triplet[2] === 0) {
                            result += "mười ";
                        } else {
                            result += "mười " + (triplet[2] === 5 ? "lăm " : units[triplet[2]] + " ");
                        }
                    } else {
                        result += tens[triplet[1]] + " ";
                        if (triplet[2] === 1) {
                            result += "mốt ";
                        } else if (triplet[2] === 5) {
                            result += "lăm ";
                        } else if (triplet[2] !== 0) {
                            result += units[triplet[2]] + " ";
                        }
                    }
                } else if (triplet[2] !== 0) {
                    result += "lẻ " + units[triplet[2]] + " ";
                }
                
                return result;
            }
            
            let result = "";
            let numStr = Math.floor(number).toString();
            
            // Pad with zeros to make length multiple of 3
            while (numStr.length % 3 !== 0) {
                numStr = "0" + numStr;
            }
            
            // Process each group of 3 digits
            const groups = numStr.match(/.{3}/g);
            
            for (let i = 0; i < groups.length; i++) {
                const group = groups[i];
                const triplet = [parseInt(group[0]), parseInt(group[1]), parseInt(group[2])];
                
                // Skip empty groups
                if (triplet[0] === 0 && triplet[1] === 0 && triplet[2] === 0) {
                    continue;
                }
                
                result += readGroup(triplet) + scales[groups.length - i - 1] + " ";
            }
            
            result = result.trim();
            // Capitalize first letter
            result = result.charAt(0).toUpperCase() + result.slice(1);
            
            return result + " đồng";
        }

        let currentAccountIndex = 0;
        const bankAccounts = [
            {
                accountNumber: '0281000569347',
                accountHolder: 'DO THI KIM THUY',
                bank: 'Ngân Hàng Vietcombank'
            },
            {
                accountNumber: '1025576073',
                accountHolder: 'CONG TY CO PHAN TAP DOAN WOWS',
                bank: 'Ngân Hàng Vietcombank'
            }
        ];

        function toggleBankAccount() {
            currentAccountIndex = (currentAccountIndex + 1) % bankAccounts.length;

            // Cập nhật dropdown để phản ánh tài khoản hiện tại
            document.getElementById('accountSelect').value = currentAccountIndex;

            // Cập nhật thông tin tài khoản hiển thị
            updateBankDetails();
        }

        function updateBankDetails() {
            const selectElement = document.getElementById('accountSelect');
            const selectedAccount = bankAccounts[selectElement.value];

            document.getElementById('accountNumber').textContent = selectedAccount.accountNumber;
            document.getElementById('accountHolder').textContent = selectedAccount.accountHolder;
            document.getElementById('bankName').textContent = selectedAccount.bank;
        }

        // Initialize with the first account
        updateBankDetails();

        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        // Function to set text content if element exists
        function setTextContentById(id, value) {
            var element = document.getElementById(id);
            if (element) {
                element.textContent = value;
            }
        }

        function print() {
            $('#content').printThis({
                debug: false, // show the iframe for debugging
                importCSS: true, // import parent page css
                importStyle: true, // import style tags
                printContainer: true, // print outer container/$.selector
                // loadCSS: ["assets/vendors/base/vendors.bundle.css", ""], // path to additional css file - use an array [] for multiple
                pageTitle: "", // add title to print page
                removeInline: false, // remove inline styles from print elements
                removeInlineSelector: "*", // custom selectors to filter inline styles. removeInline must be true
                printDelay: 333, // variable print delay
                header: null, // prefix to html
                footer: null, // postfix to html
                base: false, // preserve the BASE tag or accept a string for the URL
                formValues: true, // preserve input/form values
                canvas: false, // copy canvas content
                removeScripts: false, // remove script tags from print content
                copyTagClasses: false, // copy classes from the html & body tag
                beforePrintEvent: null, // function for printEvent in iframe
                beforePrint: null, // function called before iframe is filled
                afterPrint: null // function called before iframe is removed
            });
        }

        // Thêm vào phần script
        let signatureVisible = true;

        function toggleSignature() {
            signatureVisible = !signatureVisible;
            const signatureImage = document.getElementById('signatureImage');
            const signatureButtonText = document.getElementById('signatureButtonText');
            
            if (signatureVisible) {
                signatureImage.style.display = 'inline';
                signatureButtonText.textContent = 'Ẩn chữ ký';
            } else {
                signatureImage.style.display = 'none';
                signatureButtonText.textContent = 'Hiện chữ ký';
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            // Get parameters from URL and set content
            var parameters = ['idhd', 'tvt', 'idhd1', 'name', 'cty', 'dclh', 'mst', 'ndtt', 'ltt', 'ltt2', 'ttt'];
            parameters.forEach(function (param) {
                var value = getUrlParameter(param);
                setTextContentById(param, value);
            });
            
            // Convert amount to text
            var ttt = getUrlParameter('ttt');
            if (ttt) {
                var amount = Number(ttt.replace(/\./g, ''));
                document.getElementById('tttbc').textContent = convertNumberToVietnamese(amount);
            }
            
            // Lấy ngày hôm nay
            var today = new Date();
            var day = today.getDate();
            var month = today.getMonth() + 1; // Tháng bắt đầu từ 0
            var year = today.getFullYear();

            // Điền ngày hôm nay vào các ô input
            document.getElementById('day').value = day;
            document.getElementById('month').value = month;
            document.getElementById('year').value = year;

            // Lấy ngày hiện tại
            var day = String(today.getDate()).padStart(2, '0');
            var month = String(today.getMonth() + 1).padStart(2, '0'); // Tháng bắt đầu từ 0

            // Điền ngày và tháng vào span
            var currentDateSpan = document.getElementById('currentDate');
            currentDateSpan.textContent = day + '.' + month;

            // Xử lý số thứ tự
            var sequenceInput = document.getElementById('sequenceNumber');
            var sequenceDisplay = document.getElementById('sequenceNumberDisplay');

            sequenceInput.addEventListener('input', function () {
                var value = this.value.padStart(3, '0');
                sequenceDisplay.textContent = value;
            });
        });
    </script>
</body>

</html>